<turbo-frame id="modal">
  <div class="fixed inset-0 bg-black/40 z-40"></div>
  <div class="fixed inset-x-0 bottom-0 top-4 z-50 bg-white rounded-t-2xl shadow-2xl overflow-y-auto sm:inset-x-auto sm:left-1/2 sm:-translate-x-1/2 sm:max-w-lg sm:top-12 sm:bottom-12 sm:rounded-2xl">
    <%# Header with back button, room score, and room name %>
    <div class="sticky top-0 bg-emerald-700 text-white px-4 py-3 rounded-t-2xl sm:rounded-t-2xl">
      <div class="flex items-center justify-between">
        <a href="<%= root_path %>" data-turbo-frame="modal" class="p-1 hover:opacity-80">
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
          </svg>
        </a>
        <span class="font-medium">House Health Tracker</span>
        <div class="flex items-center gap-2">
          <div class="w-3 h-3 rounded-full" style="background-color: <%= score_color(@room.score) %>"></div>
          <span class="font-bold"><%= @room.score || "--" %></span>
        </div>
      </div>
    </div>

    <%# Room name subheader %>
    <div class="px-5 py-3 border-b bg-gray-50 text-center">
      <h2 class="text-lg font-bold text-gray-800"><%= @room.name %></h2>
    </div>

    <%# Task list %>
    <div class="p-4 space-y-2">
      <% if @tasks.any? %>
        <% @tasks.each do |task| %>
          <div class="flex items-center justify-between gap-4 bg-white rounded-xl p-4 shadow-sm">
            <div class="flex items-center gap-2 min-w-0">
              <span class="font-medium text-gray-800 truncate"><%= task.name %></span>
              <div class="w-2.5 h-2.5 rounded-full flex-shrink-0" style="background-color: <%= score_color(task.health_score) %>"></div>
              <span class="text-sm font-semibold flex-shrink-0" style="color: <%= score_color(task.health_score) %>"><%= task.health_score %></span>
            </div>
            <%= form_with url: task_completions_path(task), method: :post, class: "flex-shrink-0 ml-auto" do |f| %>
              <%= f.submit "Done",
                  class: "bg-emerald-700 text-white px-5 py-2.5 rounded-lg text-sm font-semibold hover:bg-emerald-800 active:scale-95 transition-transform cursor-pointer min-h-[44px]",
                  data: { turbo_submits_with: "..." } %>
            <% end %>
          </div>
        <% end %>
      <% else %>
        <div class="text-center py-8">
          <p class="text-gray-500 mb-4">No tasks in this room yet</p>
          <%= link_to "Add your first task", new_room_task_path(@room),
              class: "text-blue-600 font-medium hover:underline" %>
        </div>
      <% end %>
    </div>
  </div>
</turbo-frame>
